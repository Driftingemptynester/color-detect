# color-detect
 Appreciate masterpieces from the perspective of small data
1.	项目背景介绍
1.1	 引言
所谓印象主义(Impressionism)，指不依据可靠的知识，以瞬间的印象作画。画家们只是抓住一个具有特点的侧面去作画，疾飞画笔把颜色直接涂在画布上，只考虑画的总体效果，较少的顾及枝节细部，以粗放的笔法作画，缺乏修饰，是一种对笔法较草率的画法。
你也许不了解印象派绘画，但你或多或少听到过这些画家的名字，莫奈、梵高、塞尚、高更..．等，或者在不知何处看过他们的著作(图一)，心灵便被这独特的艺术冲击。

















有人说要想欣赏一幅印象主义的绘画，得先后退几步，去领略光影交织的美感和色块在眼前活跃起来的奇迹。
但作为一个“外行人”，如果没有上过美术鉴赏之类的课程，也没有那么多参加艺术展的机会，该如何鉴赏这些作品呢？或许Azure认知服务提供的配色方案检测和PowerBI的词云功能可以让我这样的“外行人”看个热闹。
1.2	应用场景分析
Azure认知服务中提供的配色方案检测，能从一张静态图片中得到丰富的信息，并以json格式返回，包括Objects, description, color等，






















其中就包括了我们需要的color配色，














可以看到，Azure的配色检测主要包括前景色(dominantColorForeground)，背景色(dominantColorBackground)、主色(dominantColors)以及以16进制RGB颜色值表示的主题色(accentColor)。通过使用这个功能，我们或许就能得到大师某副作品的配色方案了！
但如果想要鉴赏大师们的作品集，这该如何是好？毕竟作品集有数张。更进一步，如果我想知道某位大师绘画生涯中偏好的颜色是什么，那这个只能分析一张作品的功能或许帮不上多大的忙了。
不用为此发愁！PowerBI的词云功能来帮忙，借助可视化的词云，能将单独的数据汇合到一起，使得互联网上大量的信息以关键词的形式被呈现出来，以达到视觉上的突出，出现频率最多的词通常会被加以醒目的颜色并放在图像偏向中间的位置。这样的构图更加直观地展示了核心信息。
若能将上述2个功能结合，就能以词云将大师艺术生涯中偏爱的配色方案变得可视化了！





 
2.	项目执行步骤
2.1		开发环境和工具
Pycharm 2018.2.4 x64	PowerBI	Azure认知服务		Windows10
2.2		收集数据
	这里可以直接从维基百科上爬各个印象派大师的代表作，也可以直接在kaggle上下载相关数据集（数据集中共有13位印象派及后印象派画家）(https://www.kaggle.com/ikarus777/best-artworks-of-all-time)
需要注意的是裁剪前后的图片大小均需小于4M大于10000B(9.766KB)。
否则API无法分析





	印象派中的“印象”一词源自名作《印象·日出》，这里就用印象派代表人物及创始人之一，Monet的数据集做个展示吧。 
2.3		识别出画作中所有对象并做切割
一张作品中可能会使用多种配色，为了从单一画作中得到更丰富的信息，我们可以利用认知服务中识别出Objects的信息(x,y,w,h),根据此信息使用Opencv处理识别出的图像中的各个物体，将他们分别切割成为新的图像。下面演示的是Monet其中一张作品前后分割情况。




利用Opencv分割出的物体，可以分别得到其配色方案，




















而没有被识别出对象的画作(如风景画等)，使用其原有的配色方案作为数据。
2.4	  使用Azure认知服务得到配色信息并导出excel
将经过处理的所有数据(图像)放到一个新的文件夹中，分析这个文件夹中的所有数据，并将各个图片的配色方案导出到excel表格中。这里是Monet的部分代表作的配色信息。










2.5	  使用PowerBI词云进行数据可视化
得到配色信息的excel表格后，我们就可以在PowerBI中导入excel表格，用词云进行数据可视化了。

 
3.	分析与总结
3.1 结果分析及设想
从上图的词云可以看出，作为主要前景色、背景色的灰白黑占比较多，此外，棕色，黄色，绿色似乎是大师Monet偏爱的配色。
但我们仍能发现 PowerBI的词云似乎还不够“智能”，若其能对词语本身的含义有所了解，或许不至于将灰色显示为绿色，或许甚至能显示出16位进制RGB颜色值代表的颜色…
除此之外，通过将不同的值添加到visualFeatures查询参数，我们可以得到其他独特的信息。如通过添加objects和color参数，可得到本次展示所需的对图片中各种对象及其配色方案的检测。
以图2-3为例，添加Description参数，返回json内容为：
{ "tags": [ "person", "outdoor", "sitting", "table", "man", "woman", "people", "grass", "holding", "dog", "group", "park", "standing", "glasses", "plate" ], 
"captions": [ { "text": "a group of people sitting at a table", "confidence": 0.840579569 } ] }

而添加adults参数则可以得到如下内容：
'adult': {'isAdultContent': False, 'isRacyContent': False, 'isGoryContent': False, 'adultScore': 0.16193826496601105, 'racyScore': 0.19688065350055695,
 'goreScore': 0.5931507349014282},
 
通过以上工具和数据，我们或许还可以分析出大师画作中Adult content的占比几何，又或许可以分析出大师们在他们艺术生涯的不同时期偏好的各种配色，偏好的各种绘画对象，从而推断出大师在此时期的境遇及心理表现，透过简单的数据看到更深层的内容…
可以大胆假设，对艺术研究的从业者而言，这些工具和数据或许能给他们的工作带来更多的便利。
感兴趣的小伙伴们也可以现在动起手来分析自己偏好的内容。希望此文能抛砖引玉，未来能看到更多有趣的作品。
3.2 原理分析
1.	循环读取文件夹中文件，检测大小是否符合标准，若不符合，先缩放到合适大小(>=10KB&&<4M),然后上传api,分析得出有几个对象，他们的 x y w h 
2.	根据上一步得到的对象的坐标，用open cv 切割 放到一个新文件夹(master_crop)
3.	再循环读取新文件夹中的图片（都是裁剪过的，或者没被识别出对象的原图），检测大小是否符合标准，若不符合，先缩放到合适大小(>=10KB&&<4M),再传到api上
4.	从分析（json）中得到color,并输出到excel中
5.	使用上述数据在PowerBI中生成词云图

